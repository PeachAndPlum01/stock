DROP DATABASE IF EXISTS stock_investment;
CREATE DATABASE stock_investment DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

USE stock_investment;

-- 用户表
CREATE TABLE `sys_user` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `username` VARCHAR(50) NOT NULL COMMENT '用户名',
  `password` VARCHAR(100) NOT NULL COMMENT '密码',
  `nickname` VARCHAR(50) DEFAULT NULL COMMENT '昵称',
  `email` VARCHAR(100) DEFAULT NULL COMMENT '邮箱',
  `phone` VARCHAR(20) DEFAULT NULL COMMENT '手机号',
  `status` TINYINT DEFAULT 1 COMMENT '状态：0-禁用，1-启用',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_username` (`username`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';

-- 投资信息表（模拟股票数据）
CREATE TABLE `investment_info` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `title` VARCHAR(200) NOT NULL COMMENT '题材概念（如：人工智能、新能源等，逗号分隔）',
  `province` VARCHAR(50) NOT NULL COMMENT '省份（上市公司注册地，简称）',
  `province_code` VARCHAR(10) NOT NULL COMMENT '省份编码',
  `city` VARCHAR(50) DEFAULT NULL COMMENT '城市',
  `company_name` VARCHAR(200) DEFAULT NULL COMMENT '股票名称',
  `industry` VARCHAR(100) DEFAULT NULL COMMENT '股票代码',
  `investment_amount` DECIMAL(15,2) DEFAULT NULL COMMENT '当前价格（元）',
  `investment_type` VARCHAR(50) DEFAULT NULL COMMENT '市盈率',
  `ten_day_change` DECIMAL(10,2) DEFAULT NULL COMMENT '近十日总涨幅（%）',
  `one_day_change` DECIMAL(10,2) DEFAULT NULL COMMENT '当日涨跌幅（%）',
  `volume` BIGINT DEFAULT NULL COMMENT '成交量（手）',
  `turnover` DECIMAL(20,2) DEFAULT NULL COMMENT '成交额（元）',
  `market_cap` DECIMAL(20,2) DEFAULT NULL COMMENT '市值（元）',
  `description` TEXT COMMENT '公司简介',
  `related_provinces` VARCHAR(500) DEFAULT NULL COMMENT '关联省份（逗号分隔）',
  `main_concepts` VARCHAR(500) DEFAULT NULL COMMENT '主要概念题材（逗号分隔，前3个）',
  `theme_tags` VARCHAR(500) DEFAULT NULL COMMENT '题材标签（逗号分隔）',
  `rising_reason` TEXT DEFAULT NULL COMMENT '上涨原因说明',
  `investment_date` DATE DEFAULT NULL COMMENT '数据日期',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `status` TINYINT DEFAULT 1 COMMENT '状态：0-无效，1-有效',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `idx_province` (`province`),
  KEY `idx_province_code` (`province_code`),
  KEY `idx_investment_date` (`investment_date`),
  KEY `idx_ten_day_change` (`ten_day_change`),
  KEY `idx_industry` (`industry`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='股票信息表';

-- 初始化用户数据（密码为123456的MD5加密）
INSERT INTO `sys_user` (`username`, `password`, `nickname`, `email`, `status`) VALUES
('admin', 'e10adc3949ba59abbe56e057f20f883e', '管理员', 'admin@example.com', 1),
('test', 'e10adc3949ba59abbe56e057f20f883e', '测试用户', 'test@example.com', 1);

-- 初始化股票信息数据（模拟数据，包含近十日总涨幅）
INSERT INTO `investment_info` (`title`, `province`, `province_code`, `city`, `company_name`, `industry`, `investment_amount`, `investment_type`, `ten_day_change`, `description`, `related_provinces`, `investment_date`) VALUES
('人工智能,芯片,高端制造', '京', '110000', '北京市', '中芯国际', '688981', 45.50, 32.5, 15.68, '中国大陆规模最大、技术最先进的集成电路芯片制造企业', '沪,粤,浙', '2026-01-15'),
('金融科技,数字货币,区块链', '沪', '310000', '上海市', '东方财富', '300059', 18.20, 28.3, 12.35, '中国领先的互联网财经信息平台和数据服务商', '浙,苏,京', '2026-01-20'),
('新能源,锂电池,储能', '粤', '440000', '深圳市', '比亚迪', '002594', 268.50, 45.2, 8.96, '全球领先的新能源汽车制造商和电池供应商', '湘,赣,闽', '2026-01-18'),
('数字经济,云计算,大数据', '浙', '330000', '杭州市', '阿里巴巴', '09988', 85.30, 18.6, 6.52, '中国最大的电子商务平台和云计算服务商', '沪,苏,皖', '2026-01-22'),
('智能制造,工业4.0,机器人', '苏', '320000', '苏州市', '汇川技术', '300124', 72.80, 38.9, 10.24, '国内工业自动化控制领域的领军企业', '沪,浙,皖', '2026-01-25'),
('半导体,芯片设计,集成电路', '川', '510000', '成都市', '士兰微', '600460', 22.60, 65.8, 14.32, '国内领先的半导体IDM厂商', '渝,陕,贵', '2026-01-12'),
('生物医药,创新药,疫苗', '鄂', '420000', '武汉市', '智飞生物', '300122', 98.50, 25.4, 7.85, '中国领先的疫苗和生物制品研发生产企业', '湘,豫,皖', '2026-01-28'),
('海洋经济,海水养殖,冷链物流', '鲁', '370000', '青岛市', '东方海洋', '002086', 8.45, -12.8, -3.25, '集海洋水产品加工、冷藏物流于一体的大型企业', '苏,冀,辽', '2026-01-10'),
('物流,冷链,供应链', '豫', '410000', '郑州市', '顺丰控股', '002352', 52.80, 22.1, 5.68, '中国最大的综合物流服务商', '鄂,鲁,陕', '2026-01-16'),
('航空航天,军工,卫星', '陕', '610000', '西安市', '中航西飞', '000768', 28.60, 58.3, 11.45, '中国军用运输机和中型轰炸机的主制造商', '川,甘,豫', '2026-01-14'),
('电子信息,集成电路,显示技术', '闽', '350000', '厦门市', '三安光电', '600703', 15.80, 42.6, 9.87, '国内LED芯片领域的龙头企业', '粤,浙,赣', '2026-01-26'),
('工程机械,装备制造,轨道交通', '湘', '430000', '长沙市', '三一重工', '600031', 18.50, 15.2, 4.23, '全球领先的工程机械制造商', '粤,鄂,赣', '2026-01-19'),
('新型显示,MiniLED,OLED', '皖', '340000', '合肥市', '京东方A', '000725', 4.25, 28.9, 8.15, '全球半导体显示产业领先企业', '苏,浙,赣', '2026-01-21'),
('新能源汽车,智能网联,汽车电子', '渝', '500000', '重庆市', '长安汽车', '000625', 16.20, 12.5, 3.56, '中国四大汽车集团之一', '川,贵,鄂', '2026-01-17'),
('装备制造,智能制造,数控机床', '辽', '210000', '沈阳市', '沈阳机床', '000410', 6.80, -8.5, -2.14, '中国最大的机床制造商', '吉,黑,冀', '2026-01-23'),
('量子科技,通信技术,信息安全', '京', '110000', '北京市', '国盾量子', '688027', 88.60, 125.6, 18.92, '中国量子通信领域的领军企业', '沪,皖,粤', '2026-01-11'),
('集成电路,芯片制造,半导体设备', '沪', '310000', '上海市', '中微公司', '688012', 158.20, 68.5, 16.78, '国内高端半导体设备制造商', '苏,浙,京', '2026-01-13'),
('生物科技,创新药,CRO', '粤', '440000', '广州市', '药明康德', '603259', 95.30, 35.8, 7.32, '全球领先的医药研发外包服务商', '闽,湘,赣', '2026-01-24'),
('智能家居,物联网,消费电子', '浙', '330000', '宁波市', '宁波华翔', '002048', 12.60, 18.2, 4.56, '国内汽车内饰件和智能家居产品的领先企业', '沪,苏,闽', '2026-01-27'),
('新材料,石墨烯,复合材料', '苏', '320000', '南京市', '中材科技', '002080', 28.40, 32.6, 6.89, '中国建材集团旗下新材料产业平台', '沪,浙,皖', '2026-01-29'),
('智慧港口,港口机械,海洋装备', '津', '120000', '天津市', '振华重工', '600320', 5.20, 48.5, 9.34, '全球最大的港口机械制造商', '冀,京,鲁', '2025-12-15'),
('清洁能源,风电,光伏,储能', '冀', '130000', '石家庄市', '晶澳科技', '002459', 32.80, 22.4, 7.65, '全球领先的高性能光伏产品制造商', '津,晋,蒙', '2025-12-20'),
('煤炭,煤化工,清洁能源', '晋', '140000', '太原市', '山西焦煤', '000983', 8.90, 15.8, 2.45, '山西省最大的煤炭生产企业', '陕,冀,蒙', '2025-12-18'),
('稀土,新材料,磁材', '蒙', '150000', '包头市', '北方稀土', '600111', 35.60, 48.2, 12.87, '全球最大的轻稀土供应商', '晋,宁,甘', '2025-12-22'),
('生物育种,农业科技,种子', '吉', '220000', '长春市', '隆平高科', '000998', 18.20, 38.5, 5.92, '中国种业龙头企业', '黑,辽,蒙', '2025-12-25'),
('现代农业,智慧农业,农业装备', '黑', '230000', '哈尔滨市', '北大荒', '600598', 15.40, 25.6, 3.21, '中国最大的现代化农业企业集团', '吉,蒙,辽', '2025-12-12'),
('航空制造,军工,新材料', '赣', '360000', '南昌市', '洪都航空', '600316', 32.50, 68.9, 13.45, '中国教练机和导弹的定点生产企业', '湘,闽,皖', '2025-12-28'),
('大数据,云计算,数据中心', '贵', '520000', '贵阳市', '朗玛信息', '300288', 28.60, 52.3, 9.87, '贵州大数据产业的领军企业', '川,云,渝', '2025-12-10'),
('生物医药,中药,健康产业', '云', '530000', '昆明市', '云南白药', '000538', 68.50, 28.5, 6.23, '中华老字号中药龙头企业', '贵,川,藏', '2025-12-16'),
('清洁能源,水电,新能源', '藏', '540000', '拉萨市', '西藏药业', '600211', 25.80, 42.6, 8.92, '西藏地区最大的医药企业', '青,川,云', '2025-12-19'),
('新能源装备,风电,光伏', '甘', '620000', '兰州市', '中核钛白', '002145', 8.50, 32.8, 5.67, '国内钛白粉行业的龙头企业', '青,宁,陕', '2025-12-21'),
('盐湖提锂,锂资源,新能源', '青', '630000', '西宁市', '盐湖股份', '000792', 22.40, 18.5, 10.34, '全球最大的盐湖提锂企业', '甘,藏,新', '2025-12-23'),
('葡萄酒,特色农业,休闲农业', '宁', '640000', '银川市', '张裕A', '000869', 32.60, 28.9, 4.18, '中国葡萄酒行业的龙头企业', '甘,陕,蒙', '2025-12-26'),
('纺织产业,棉纺,化纤', '新', '650000', '乌鲁木齐市', '中泰化学', '002092', 12.50, 22.6, 25.68, '新疆最大的氯碱化工企业', '青,甘', '2025-12-11'),
('煤炭,煤化工,清洁能源', '新', '650000', '乌鲁木齐市', '特变电工', '600089', 18.60, 18.5, 22.45, '中国变压器行业龙头企业', '甘,陕,蒙', '2026-01-11'),
('新能源,风电,光伏', '新', '650000', '乌鲁木齐市', '金风科技', '002202', 15.80, 32.6, 21.32, '中国风电设备制造商龙头企业', '京,甘', '2026-01-12'),
('纺织产业,棉纺,农业', '新', '650000', '阿克苏市', '新农开发', '600359', 8.45, 28.9, 19.87, '新疆农业产业化重点企业', '甘,陕', '2026-01-13'),
('农业,农产品加工,食品', '新', '650000', '昌吉市', '中粮糖业', '600737', 7.20, 15.6, 18.56, '中国最大的番茄加工企业', '蒙,甘', '2026-01-14'),
('化工,化肥,新材料', '新', '650000', '石河子市', '新疆天业', '600075', 6.80, 35.8, 17.23, '新疆大型化工企业', '甘,陕', '2026-01-15'),
('新能源,锂电,储能', '新', '650000', '乌鲁木齐市', '大全能源', '688303', 45.60, 42.5, 16.89, '国内高纯多晶硅领先企业', '青,甘', '2026-01-16'),
('农业,种植,食品加工', '新', '650000', '乌鲁木齐市', '中基健康', '000972', 5.20, -8.6, 15.45, '新疆番茄制品加工企业', '甘,陕', '2026-01-17'),
('数字贸易,跨境电商,自贸港', '琼', '460000', '海口市', '海南橡胶', '601118', 6.80, -15.2, -5.67, '中国最大的天然橡胶生产企业', '粤,桂,闽', '2025-12-13'),
('国际贸易,跨境电商,供应链', '桂', '450000', '南宁市', '柳工', '000528', 9.20, 18.6, 4.32, '中国工程机械行业的领军企业', '粤,云,贵', '2025-12-17'),
('生命科学,医疗器械,创新药', '京', '110000', '北京市', '迈瑞医疗', '300760', 328.50, 48.5, 11.23, '中国最大的医疗器械企业', '津,冀,沪', '2025-12-24'),
('航运物流,港口,海运', '沪', '310000', '上海市', '中远海控', '601919', 12.80, 8.5, 3.45, '全球领先的集装箱航运企业', '浙,苏,闽', '2025-12-14'),
('科技创新,人工智能,大湾区', '粤', '440000', '深圳市', '腾讯控股', '00700', 385.20, 22.8, 9.56, '全球最大的互联网科技公司之一', '港,澳,闽', '2025-12-27'),
('跨境电商,数字贸易,电商', '浙', '330000', '杭州市', '跨境通', '002640', 5.60, -25.6, -8.92, '中国跨境电商行业的龙头企业', '沪,苏,闽', '2025-12-29'),
('工业互联网,智能制造,数字化', '苏', '320000', '无锡市', '徐工机械', '000425', 7.80, 22.5, 5.78, '中国工程机械行业的领军企业', '沪,浙,鲁', '2026-01-05'),
('氢能源,燃料电池,新能源', '川', '510000', '成都市', '厚普股份', '300471', 15.20, 35.8, 7.89, '国内氢能源装备领域的领先企业', '渝,云,贵', '2026-01-08'),
('光电子,激光,半导体', '鄂', '420000', '武汉市', '光迅科技', '002281', 32.50, 42.6, 10.23, '国内光电子领域的龙头企业', '湘,豫,赣', '2026-01-06'),
('海洋牧场,海洋渔业,海产品', '鲁', '370000', '烟台市', '好当家', '600467', 4.50, 28.6, 6.12, '国内最大的海洋渔业企业', '苏,辽,冀', '2026-01-09'),
('农业装备,智能农机,农业机械', '豫', '410000', '洛阳市', '一拖股份', '601038', 12.80, 32.5, 4.87, '中国农业机械行业的领军企业', '鲁,皖,陕', '2026-01-03'),
('文化旅游,旅游,文化传媒', '陕', '610000', '西安市', '曲江文旅', '600706', 8.50, 48.6, 3.25, '西安文化旅游产业的核心企业', '甘,豫,川', '2026-01-07'),
('海洋新材料,新材料,高端制造', '闽', '350000', '福州市', '福耀玻璃', '600660', 45.60, 22.5, 5.56, '全球最大的汽车玻璃制造商', '浙,粤,赣', '2026-01-04'),
('工程机械,智能制造,装备制造', '湘', '430000', '长沙市', '山河智能', '002097', 8.20, 28.9, 6.78, '国内工程机械行业的领军企业', '粤,赣,鄂', '2026-01-02'),
('量子信息,量子通信,量子计算', '皖', '340000', '合肥市', '科大国盾', '未上市', 0.00, 0.0, 0.00, '中国量子信息产业的核心企业', '苏,浙,沪', '2026-01-01');

-- 省份相关度表
CREATE TABLE `related_provinces` (
  `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `source_province` VARCHAR(10) NOT NULL COMMENT '源省份（简称）',
  `source_province_code` VARCHAR(10) NOT NULL COMMENT '源省份编码',
  `target_province` VARCHAR(10) NOT NULL COMMENT '目标省份（简称）',
  `target_province_code` VARCHAR(10) NOT NULL COMMENT '目标省份编码',
  `correlation_score` DECIMAL(10,6) DEFAULT 0 COMMENT '相关度得分（0-1之间）',
  `concept_similarity` DECIMAL(10,6) DEFAULT 0 COMMENT '概念题材相似度（0-1之间）',
  `industry_similarity` DECIMAL(10,6) DEFAULT 0 COMMENT '行业相似度（0-1之间）',
  `company_type_similarity` DECIMAL(10,6) DEFAULT 0 COMMENT '公司性质相似度（0-1之间）',
  `common_concepts` VARCHAR(500) DEFAULT NULL COMMENT '共同概念题材（逗号分隔）',
  `common_industries` VARCHAR(500) DEFAULT NULL COMMENT '共同行业（逗号分隔）',
  `correlation_reason` TEXT DEFAULT NULL COMMENT '关联原因说明（JSON格式）',
  `source_top5_stocks` TEXT DEFAULT NULL COMMENT '源省份涨幅前5股票信息（JSON）',
  `target_top5_stocks` TEXT DEFAULT NULL COMMENT '目标省份涨幅前5股票信息（JSON）',
  `calculation_method` VARCHAR(50) DEFAULT 'TOP5_SIMILARITY' COMMENT '计算方法标识',
  `create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `update_time` DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_province_pair` (`source_province`, `target_province`),
  KEY `idx_source_province` (`source_province`),
  KEY `idx_target_province` (`target_province`),
  KEY `idx_correlation_score` (`correlation_score`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='省份相关度表（基于涨幅前5股票相似度）';
